<!--[if IE]>
<meta http-equiv="X-UA-Compatible" content="IE=5"><![endif]-->
<!DOCTYPE html>
<html>
<head>
  <title>Flowchart Maker &amp; Online Diagram Software</title>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="msapplication-config" content="images/browserconfig.xml">
  <meta name="mobile-web-app-capable" content="yes">
  <script type="text/javascript">
    var mxIsElectron = window && window.process && window.process.type;

    /**
     * URL Parameters and protocol description are here:
     *
     * https://desk.draw.io/support/solutions/articles/16000042546-what-url-parameters-are-supported
     *
     * Parameters for developers:
     *
     * - dev=1: For developers only
     * - test=1: For developers only
     * - export=URL for export: For developers only
     * - ignoremime=1: For developers only (see DriveClient.js). Use Cmd-S to override mime.
     * - createindex=1: For developers only (see etc/build/README)
     * - filesupport=0: For developers only (see Editor.js in core)
     * - savesidebar=1: For developers only (see Sidebar.js)
     * - pages=1: For developers only (see Pages.js)
     * - lic=email: For developers only (see LicenseServlet.java)
     * --
     * - networkshapes=1: For testing network shapes (temporary)
     */
    var urlParams = (function () {
      var result = new Object();
      var params = window.location.search.slice(1).split('&');

      for (var i = 0; i < params.length; i++) {
        idx = params[i].indexOf('=');

        if (idx > 0) {
          result[params[i].substring(0, idx)] = params[i].substring(idx + 1);
        }
      }

      return result;
    })();

    // Forces CDN caches by passing URL parameters via URL hash
    if (window.location.hash != null && window.location.hash.substring(0, 2) == '#P') {
      try {
        urlParams = JSON.parse(decodeURIComponent(window.location.hash.substring(2)));

        if (urlParams.hash != null) {
          window.location.hash = urlParams.hash;
        }
      }
      catch (e) {
        // ignore
      }
    }

    // Redirects page if required
    if (urlParams['dev'] != '1') {
      (function () {
        var proto = window.location.protocol;

        if (!mxIsElectron) {
          var host = window.location.host;

          // Redirects apex, drive and rt to www
          if (host === 'draw.io' || host === 'rt.draw.io' || host === 'drive.draw.io') {
            host = 'www.draw.io';
          }

          var href = proto + '//' + host + window.location.href.substring(
            window.location.protocol.length +
            window.location.host.length + 2);

          // Redirects if href changes
          if (href != window.location.href) {
            window.location.href = href;
          }
        }
      })();
    }

    /**
     * Adds meta tags with application name (depends on offline URL parameter)
     */
    (function () {
      function addMeta(name, content, httpEquiv) {
        try {
          var s = document.createElement('meta');

          if (name != null) {
            s.setAttribute('name', name);
          }

          s.setAttribute('content', content);

          if (httpEquiv != null) {
            s.setAttribute('http-equiv', httpEquiv);
          }

          var t = document.getElementsByTagName('meta')[0];
          t.parentNode.insertBefore(s, t);
        }
        catch (e) {
          // ignore
        }
      };

      var name = 'diagrams.net';
      addMeta('apple-mobile-web-app-title', name);
      addMeta('application-name', name);

      if (mxIsElectron) {
        addMeta(null, 'default-src \'self\' \'unsafe-inline\'; connect-src \'self\' https://*.draw.io https://fonts.googleapis.com https://fonts.gstatic.com; img-src * data:; media-src *; font-src *; style-src-elem \'self\' \'unsafe-inline\' https://fonts.googleapis.com', 'Content-Security-Policy');
      }
    })();
  </script>
  <link rel="stylesheet" type="text/css" href="js/croppie/croppie.min.css">
  <link rel="stylesheet" type="text/css" href="styles/grapheditor.css">
  <!--<link rel="manifest" href="images/manifest.json">-->
  <!-- import Vue before Element -->
  <script src="js/other/vue.js"></script>
  <!-- 引入样式 -->
  <link rel="stylesheet" href="element-ui/element.css">
  <!-- 引入组件库 -->
  <script src="element-ui/element.js"></script>
  <link rel="stylesheet" href="css/my-proj.css">
  <script src="js/myProj/utils.js"></script>
  <script src="js/myProj/nodeAttributes.js"></script>

  <style type="text/css">
    html,
    body{
      height: 100%;
      width: 100%;
    }
    body{
      overflow: hidden;
      margin: 0;
      padding: 0;
      font-size: 12px;
      font-family: Microsoft YaHei,Avenir, Helvetica, Arial, sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    .myMainContainer{
      position: relative;
      width: 100%;
      height: 100%;
    }

    div.picker {
      z-index: 10007;
    }

    .geSidebarContainer .geTitle input {
      font-size: 8pt;
      color: #606060;
    }

    .geBlock {
      z-index: -3;
      margin: 100px;
      margin-top: 40px;
      margin-bottom: 30px;
      padding: 20px;
    }

    .geBlock h1, .geBlock h2 {
      margin-top: 0px;
      padding-top: 0px;
    }

    .geEditor ::-webkit-scrollbar {
      width: 14px;
      height: 14px;
    }

    .geEditor ::-webkit-scrollbar-track {
      background-clip: padding-box;
      border: solid transparent;
      border-width: 1px;
    }

    .geEditor ::-webkit-scrollbar-corner {
      background-color: transparent;
    }

    .geEditor ::-webkit-scrollbar-thumb {
      background-color: rgba(0, 0, 0, .1);
      background-clip: padding-box;
      border: solid transparent;
      border-radius: 10px;
    }

    .geEditor ::-webkit-scrollbar-thumb:hover {
      background-color: rgba(0, 0, 0, .4);
    }

    .geTemplate {
      border: 1px solid transparent;
      display: inline-block;
      _display: inline;
      vertical-align: top;
      border-radius: 3px;
      overflow: hidden;
      font-size: 14pt;
      cursor: pointer;
      margin: 5px;
    }
  </style>
  <!-- Workaround for binary XHR in IE 9/10, see App.loadUrl -->
  <!--[if (IE 9)|(IE 10)]><!-->
  <script type="text/vbscript">
			Function mxUtilsBinaryToArray(Binary)
				Dim i
				ReDim byteArray(LenB(Binary))
				For i = 1 To LenB(Binary)
					byteArray(i-1) = AscB(MidB(Binary, i, 1))
				Next
				mxUtilsBinaryToArray = byteArray
			End Function

  </script>
  <!--<![endif]-->
  <script type="text/javascript">
    /**
     * Synchronously adds scripts to the page.
     */
    function mxscript(src, onLoad, id, dataAppKey, noWrite) {
      if (onLoad != null || noWrite) {
        var s = document.createElement('script');
        s.setAttribute('type', 'text/javascript');
        s.setAttribute('src', src);
        var r = false;

        if (id != null) {
          s.setAttribute('id', id);
        }

        if (dataAppKey != null) {
          s.setAttribute('data-app-key', dataAppKey);
        }

        if (onLoad != null) {
          s.onload = s.onreadystatechange = function () {
            if (!r && (!this.readyState || this.readyState == 'complete')) {
              r = true;
              onLoad();
            }
          };
        }

        var t = document.getElementsByTagName('script')[0];

        if (t != null) {
          t.parentNode.insertBefore(s, t);
        }
      }
      else {
        console.log(src)
        document.write('<script src="' + src + '"' + ((id != null) ? ' id="' + id + '" ' : '') +
          ((dataAppKey != null) ? ' data-app-key="' + dataAppKey + '" ' : '') + '></scr' + 'ipt>');
      }
    };

    /**
     * Asynchronously adds scripts to the page.
     */
    function mxinclude(src) {
      var g = document.createElement('script');
      g.type = 'text/javascript';
      g.async = true;
      g.src = src;
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(g, s);
    };

    // Checks for local storage
    var isLocalStorage = false;

    try {
      isLocalStorage = urlParams['local'] != '1' && typeof(localStorage) != 'undefined';
    }
    catch (e) {
      // ignored
    }

    // Changes paths for local development environment
    if (urlParams['dev'] == '1') {
      var mxDevUrl = document.location.origin+document.location.pathname.replace('index.html', '');

      var geBasePath = mxDevUrl + 'js/mxgraph/';
      var drawDevUrl = mxDevUrl;
      mxscript(drawDevUrl + 'js/PreConfig.js');
      mxscript(drawDevUrl + 'js/diagramly/Init.js');
      mxscript(geBasePath + '/Init.js');
      mxscript(mxDevUrl + '/js/mxgraph/mxClient.js');

      // Adds all JS code that depends on mxClient. This indirection via Devel.js is
      // required in some browsers to make sure mxClient.js (and the files that it
      // loads asynchronously) are available when the code loaded in Devel.js runs.
      mxscript(drawDevUrl + 'js/diagramly/Devel.js');
      mxscript(drawDevUrl + 'js/PostConfig.js')
    }
    else {
      (function () {
        var hostName = window.location.hostname;

        // Supported domains are *.draw.io and the packaged version in Quip
        var supportedDomain = (hostName.substring(hostName.length - 8, hostName.length) === '.draw.io') ||
          (hostName.substring(hostName.length - 13, hostName.length) === '.diagrams.net');
        (hostName.substring(hostName.length - 17, hostName.length) === '.quipelements.com');

        if (!supportedDomain) {
          mxscript('js/PreConfig.js');// todo --执行了
        }

        mxscript('js/app.min.js');// todo --执行了

        if (!supportedDomain) {
          mxscript('js/PostConfig.js');// todo --执行了
        }
      })();
    }

    // Electron
    if (mxIsElectron) {
      mxscript('js/PreConfig.js');
      mxscript('js/diagramly/DesktopLibrary.js');
      mxscript('js/diagramly/ElectronApp.js');
      mxscript('js/extensions.min.js');
      mxscript('js/stencils.min.js');
      mxscript('js/shapes.min.js');
      mxscript('js/PostConfig.js');
    }

    // Adds basic error handling
    window.onerror = function () {
      var status = document.getElementById('geStatus');

      if (status != null) {
        status.innerHTML = 'Page could not be loaded. Please try refreshing.';
      }
    };
  </script>

</head>
<body class="geEditor33">
  <div id="geInfo">
    <div class="geBlock" style="text-align:center;min-width:50%;">
      <h1>Flowchart Maker and Online Diagram Software</h1>
      <p>
        diagrams.net (formerly draw.io) is free online diagram software. You can use it as a flowchart maker, network
        diagram software, to create UML online, as an ER diagram tool,
        to design database schema, to build BPMN online, as a circuit diagram maker, and more. draw.io can import .vsdx,
        Gliffy&trade; and Lucidchart&trade; files .
      </p>
      <h2 id="geStatus">Loading...</h2>
      <p>
        Please ensure JavaScript is enabled.
      </p>
    </div>
  </div>
  <div id="myMainContainer" class="myMainContainer"></div>
<script type="text/javascript">
  /**
   * Main
   */

  if (navigator.userAgent != null && navigator.userAgent.toLowerCase().indexOf(' electron/') >= 0 && process.versions.electron < 5) {
    // Redirects old Electron app to latest version
    var div = document.getElementById('geInfo');

    if (div != null) {
      div.innerHTML = '<center><h2>You are using an out of date version of this app.<br>Please download the latest version ' +
        '<a href="https://github.com/jgraph/drawio-desktop/releases/latest" target="_blank">here</a>.</h2></center>';
    }
  }
  else {
    debugger;
    App.main();
  }
</script>
</body>
<script>
  window.addEventListener('beforeunload', function(){
    debugger;
    // 清除所有的refs
    window.$refs = null;
  }, false);
  window.addEventListener('unload', function(){
    debugger;
    // 清除所有的refs
    window.$refs = null;
  }, false);
</script>
</html>
